{% extends 'blog/base.html' %}
{% load blog_tags %}
{% block title %}Doggo Bloggo - {{ post.title }}{% endblock %}
{% block content %}

    <div class="section">
        {% if post.header_image %}
            <img src="{{ post.header_image.url }}"
                        alt="{{ post.title }}">
        {% else %}
            <img src="https://bulma.io/images/placeholders/1280x960.png"
                        alt="Placeholder image">
        {% endif %}
        <h1 class="title is-2">{{ post.title }}</h1>
        {% include "blog/post/includes/post_tags.html" %}
        <p class="date">
            Published {{ post.publish }} by {{ post.author }}
        </p>
        <div class="content">
            {{ post.body|markdown }}
        </div>
    </div>

    <div class="section">
        <p>
            <a href="{% url 'blog:post_share' post.slug %}">Share this post</a>
        </p>
    
        <h3>Similar posts (based on tags)</h3>
        {% for spost in similar_posts %}
            <p><a href="{{ spost.get_absolute_url }}">{{ spost.title }}</a></p>
        {% empty %}
        There are no similar posts yet.
        {% endfor %}
    </div>

    <div class="section">
        {% comment %} TODO: format with Bulma forms {% endcomment %}
        {% with comments.count as total_comments %}
        <h2>{{ total_comments }} comment{{ total_comments|pluralize }} </h2>
        {% endwith %}
        {% for comment in comments %}
            <div class="comment">
                <p class="info">
                    Comment #{{ forloop.counter }} by <em>{{ comment.name }}</em>
                    {{ comment.created }}{% if comment.is_updated %}; Updated: {{ comment.updated }}{% endif %}
                </p>
                {{ comment.text|linebreaks }}
            </div>
        {% empty %}
            <p>There are no comments</p>
        {% endfor %}
        {% include "blog/post/includes/comment_form.html" %}
    </div>
{% endblock %}
{% block scripts %}
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
{% endblock %}